<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Tim Topper and Kate Chatfield-Reed">
        <link rel="canonical" href="https://ttopper.github.io/CPSC129/10.1_HTTP_REST/16_Actual_code/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Actual code - CPSC 129</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../../extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">CPSC 129</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Notes <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../.." class="dropdown-item">CPSC 129: Object-oriented Programming 2</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">01.1 Course Information</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../01.1_Course_Information/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../01.1_Course_Information/01_Course_schedule/" class="dropdown-item">Course Schedule</a>
</li>
            
<li>
    <a href="../../01.1_Course_Information/02_Marking_scheme/" class="dropdown-item">Marking Scheme</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">01.2 Conway's Game of Life 1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../01.2_CGoL_1_Introduction/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../01.2_CGoL_1_Introduction/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../01.2_CGoL_1_Introduction/02_Algorithm_overview/" class="dropdown-item">Algorithm Overview</a>
</li>
            
<li>
    <a href="../../01.2_CGoL_1_Introduction/03_Create_and_initialize_U/" class="dropdown-item">Create and Initialize the Universe</a>
</li>
            
<li>
    <a href="../../01.2_CGoL_1_Introduction/04_Display/" class="dropdown-item">Display the Universe</a>
</li>
            
<li>
    <a href="../../01.2_CGoL_1_Introduction/05_Age/" class="dropdown-item">Age the Universe</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_01/" class="dropdown-item">Assignment 1</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">02.1 Searching</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../02.1_Searching/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../02.1_Searching/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../02.1_Searching/02_Linear_Search_Unordered_List/" class="dropdown-item">Linear Search, Unordered list</a>
</li>
            
<li>
    <a href="../../02.1_Searching/03_Linear_Search_Ordered_List/" class="dropdown-item">Linear Search, Ordered List</a>
</li>
            
<li>
    <a href="../../02.1_Searching/04_Binary_Search/" class="dropdown-item">Binary Search</a>
</li>
            
<li>
    <a href="../../02.1_Searching/05_Interpolative_Search/" class="dropdown-item">Interpolative Search</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">02.2 Algorithm Analysis</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../02.2_Algorithm_Analysis/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../02.2_Algorithm_Analysis/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../02.2_Algorithm_Analysis/02_Big_O_notation/" class="dropdown-item">Big O Notation</a>
</li>
            
<li>
    <a href="../../02.2_Algorithm_Analysis/03_Linear_search/" class="dropdown-item">What Order is Linear Search?</a>
</li>
            
<li>
    <a href="../../02.2_Algorithm_Analysis/04_Binary_search/" class="dropdown-item">What Order is Binary Search?</a>
</li>
            
<li>
    <a href="../../02.2_Algorithm_Analysis/05_O_log_n_vs_O_n/" class="dropdown-item">O(log n) versus O(n)</a>
</li>
            
<li>
    <a href="../../02.2_Algorithm_Analysis/06_Algorithm_orders/" class="dropdown-item">Algorithm orders</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">02.3 PyGame 1 Drawing</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/02_pygame_test_0/" class="dropdown-item">Getting started with Pygame</a>
</li>
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/03_pygame_test_1/" class="dropdown-item">It’s installed but is Pygame actually working?</a>
</li>
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/04_pygame_test_2/" class="dropdown-item">Exiting Pygame more gracefully</a>
</li>
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/05_pygame_test_3/" class="dropdown-item">Drawing something</a>
</li>
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/06_pygame_test_4/" class="dropdown-item">Drawing lots of a thing</a>
</li>
            
<li>
    <a href="../../02.3_PyGame_1_Drawing/07_pygame_test_5/" class="dropdown-item">Drawing lots of things</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_02/" class="dropdown-item">Assignment 2</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">03.1 Recursion</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../03.1_Recursion/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../03.1_Recursion/01_Recursion_by_example/" class="dropdown-item">Recursion by Example</a>
</li>
            
<li>
    <a href="../../03.1_Recursion/02_Recursion_through_a_list/" class="dropdown-item">Recursion Through a List</a>
</li>
            
<li>
    <a href="../../03.1_Recursion/03_Calculating_factorials/" class="dropdown-item">Caculating Factorials</a>
</li>
            
<li>
    <a href="../../03.1_Recursion/04_Recursive_binary_search/" class="dropdown-item">Recursive Binary Search</a>
</li>
            
<li>
    <a href="../../03.1_Recursion/05_Recursive_data_structures/" class="dropdown-item">Recursive Data Structures</a>
</li>
            
<li>
    <a href="../../03.1_Recursion/06_recursion/" class="dropdown-item">recursion.py: Examples of recursive functions</a>
</li>
            
<li>
    <a href="../../03.1_Recursion/07_Notes/" class="dropdown-item">Recursion: Notes</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">03.2 File Processing</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../03.2_File_Processing/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/01_Persistence/" class="dropdown-item">Persistence</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/02_Text_vs_binary_files/" class="dropdown-item">Text versus Binary Files</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/03_Reading_from_text_files/" class="dropdown-item">Reading from text files</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/04_Example_searching_log_files/" class="dropdown-item">Example: Searching log files</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/05_Files_are_sequential/" class="dropdown-item">Important note: Files are sequential</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/06_Is_there_more/" class="dropdown-item">Is there more?</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/07_Writing_to_text_files/" class="dropdown-item">Writing to text files</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/08_Appending_to_files/" class="dropdown-item">Appending to files</a>
</li>
            
<li>
    <a href="../../03.2_File_Processing/09_Reading_numeric_data/" class="dropdown-item">Reading numeric data</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">03.3 CGoL 2 Persistence</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/01_Introduction/" class="dropdown-item">Designing file formats</a>
</li>
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/02_Goal/" class="dropdown-item">The goal</a>
</li>
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/03_Option_1_Screenshot/" class="dropdown-item">Option 1: Store a screenshot of the universe</a>
</li>
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/04_Option_2_Python_list/" class="dropdown-item">Option 2: Store the universe array using str(u)</a>
</li>
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/05_Option_3_Coordinate_list/" class="dropdown-item">Option 3: Store only the coordinates of live cells</a>
</li>
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/06_Option_4_Bits/" class="dropdown-item">Option 4: Use only 1 bit per cell</a>
</li>
            
<li>
    <a href="../../03.3_CGoL_2_Persistence/07_Pickling/" class="dropdown-item">Pickling</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">04.1 CRUD</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../04.1_CRUD/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../04.1_CRUD/01_Persistence/" class="dropdown-item">Persistence</a>
</li>
            
<li>
    <a href="../../04.1_CRUD/02_Pickling/" class="dropdown-item">Pickling</a>
</li>
            
<li>
    <a href="../../04.1_CRUD/03_Shelves/" class="dropdown-item">Shelves</a>
</li>
            
<li>
    <a href="../../04.1_CRUD/04_Shelve_gotcha/" class="dropdown-item">A bigger Gotcha: Shelves update on assignment not mutation</a>
</li>
            
<li>
    <a href="../../04.1_CRUD/05_Controller/" class="dropdown-item">A controller for our database</a>
</li>
            
<li>
    <a href="../../04.1_CRUD/06_The_main_event_loop/" class="dropdown-item">The main event loop</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_03/" class="dropdown-item">Assignment 3</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">04.2 MVC 1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../04.2_MVC_1/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../04.2_MVC_1/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../04.2_MVC_1/02_Step_1_Identify_model/" class="dropdown-item">Step 1: Identify the model</a>
</li>
            
<li>
    <a href="../../04.2_MVC_1/03_Step_2_Start_the_model/" class="dropdown-item">Step 2: Start the model</a>
</li>
            
<li>
    <a href="../../04.2_MVC_1/04_Step_3_The_quote_class/" class="dropdown-item">Step 3: The Quote class</a>
</li>
            
<li>
    <a href="../../04.2_MVC_1/05_UIDs/" class="dropdown-item">Unique identifiers</a>
</li>
            
<li>
    <a href="../../04.2_MVC_1/06_Step_4_Model_revisited_for_testing/" class="dropdown-item">Step 4: Model revisited for testing</a>
</li>
            
<li>
    <a href="../../04.2_MVC_1/07_Step_5_Controller_revisited/" class="dropdown-item">Step 5: Controller revisited</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">04.3 PyGame 2 Animation</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../04.3_PyGame_2_Animation/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../04.3_PyGame_2_Animation/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../04.3_PyGame_2_Animation/02_pygame_test_6/" class="dropdown-item">Making something move 1</a>
</li>
            
<li>
    <a href="../../04.3_PyGame_2_Animation/03_pygame_test_7/" class="dropdown-item">Making something move 2</a>
</li>
            
<li>
    <a href="../../04.3_PyGame_2_Animation/04_pygame_test_8/" class="dropdown-item">Making something move 3</a>
</li>
            
<li>
    <a href="../../04.3_PyGame_2_Animation/05_pygame_test_9/" class="dropdown-item">Making something move 4</a>
</li>
            
<li>
    <a href="../../04.3_PyGame_2_Animation/06_pygame_test_10/" class="dropdown-item">Making something move 5</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_04/" class="dropdown-item">Assignment 4</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">05.1 Sorting 1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../05.1_Sorting_1/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../05.1_Sorting_1/01_Sorting_out_sorting/" class="dropdown-item">Sorting Out Sorting</a>
</li>
            
<li>
    <a href="../../05.1_Sorting_1/02_Straight_insertion_sort/" class="dropdown-item">Linear Insertion Sort</a>
</li>
            
<li>
    <a href="../../05.1_Sorting_1/03_Straight_selection_sort/" class="dropdown-item">Straight Selection Sort</a>
</li>
            
<li>
    <a href="../../05.1_Sorting_1/04_Straight_exchange_sort/" class="dropdown-item">Bubble Sort</a>
</li>
            
<li>
    <a href="../../05.1_Sorting_1/05_Shell_sort/" class="dropdown-item">Shell Sort</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">05.2 CGoL 3 Speed</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../05.2_CGoL_3_Speed/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../05.2_CGoL_3_Speed/01_Where_to_begin/" class="dropdown-item">Where to Begin?</a>
</li>
            
<li>
    <a href="../../05.2_CGoL_3_Speed/02_Measure_dont_guess/" class="dropdown-item">Measure, don’t guess</a>
</li>
            
<li>
    <a href="../../05.2_CGoL_3_Speed/03_Reworking_aging/" class="dropdown-item">Reworking Aging</a>
</li>
            
<li>
    <a href="../../05.2_CGoL_3_Speed/04_The_new_aging_scheme/" class="dropdown-item">The New Aging Scheme</a>
</li>
            
<li>
    <a href="../../05.2_CGoL_3_Speed/05_Measure_again/" class="dropdown-item">Is it better? Measure Again</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_05/" class="dropdown-item">Assignment 5</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">06.1 MVC 2</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../06.1_MVC_2/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../06.1_MVC_2/01_The_issue/" class="dropdown-item">The Issue</a>
</li>
            
<li>
    <a href="../../06.1_MVC_2/02_The_payoff/" class="dropdown-item">The Payoff: An ObjectServer</a>
</li>
            
<li>
    <a href="../../06.1_MVC_2/03_Separating_controller_and_quote/" class="dropdown-item">Separating Controller and Quote</a>
</li>
            
<li>
    <a href="../../06.1_MVC_2/04_Quote_factory/" class="dropdown-item">A Quote Factory</a>
</li>
            
<li>
    <a href="../../06.1_MVC_2/05_Adding_more_object_types/" class="dropdown-item">Adding More Object Types</a>
</li>
            
<li>
    <a href="../../06.1_MVC_2/06_Your_turn/" class="dropdown-item">Your Turn</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">06.2 Mazes 1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../06.2_Mazes_1/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/01_The_problem/" class="dropdown-item">01 The problem</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/02_Approaches/" class="dropdown-item">02 Approaches</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/03_Step_1_From_english_to_pseudcode/" class="dropdown-item">Step 1: From English to Pseudocode</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/04_Step_2_Testing_our_pseudocode/" class="dropdown-item">Step 2: Testing our pseudocode</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/05_Step_3_Revise_pseudocode/" class="dropdown-item">Step 3: Revising our pseudocode</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/06_Step_4_OOP/" class="dropdown-item">Step 4: Data structures (OOP)</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/07_Step_5_Initializing_maze/" class="dropdown-item">Step 5: Initializing the maze</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/08_Step_6_Debugging_output/" class="dropdown-item">Step 6: Adding debugging output</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/09_Step_7_Sharing_walls/" class="dropdown-item">Step 7: Sharing walls</a>
</li>
            
<li>
    <a href="../../06.2_Mazes_1/10_Step_8_Put_the_pieces_together/" class="dropdown-item">Step 8: Putting the pieces together</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_06/" class="dropdown-item">Assignment 6</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">07.1 Sorting 2</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../07.1_Sorting_2/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../07.1_Sorting_2/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../07.1_Sorting_2/02_Quicksort_1/" class="dropdown-item">Quicksort</a>
</li>
            
<li>
    <a href="../../07.1_Sorting_2/03_Quicksort_2/" class="dropdown-item">A more Pythonic Quicksort</a>
</li>
            
<li>
    <a href="../../07.1_Sorting_2/04_Tree_in_a_list/" class="dropdown-item">Representing a tree using a list</a>
</li>
            
<li>
    <a href="../../07.1_Sorting_2/05_Heapsort/" class="dropdown-item">Heapsort</a>
</li>
            
<li>
    <a href="../../07.1_Sorting_2/Heapsort_old/" class="dropdown-item">Heapsort</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">07.2 CGoL 4 GUI</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../07.2_CGoL_4_GUI/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/01_The_goal/" class="dropdown-item">The Goal</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/02_Step_1_Make_a_plan/" class="dropdown-item">Step 1: Make a plan</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/03_Step_2_Review_existing_code/" class="dropdown-item">Step 2: Review existing code</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/04_Step_3_Test_existing_code/" class="dropdown-item">Step 3: Test existing code</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/05_Step_4_Make_room_for_the_menu/" class="dropdown-item">Step 4: Make room for the menu</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/06_Step_5_Refactoring_interlude/" class="dropdown-item">Step 5: Refactoring interlude</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/07_Step_6_Display_menu_icons/" class="dropdown-item">Step 6: Display the menu icons</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/08_Step_7_Map_clicks_to_actions/" class="dropdown-item">Step 7: Map mouse clicks to actions</a>
</li>
            
<li>
    <a href="../../07.2_CGoL_4_GUI/09_Step_8_Merge_ui_and_simulation/" class="dropdown-item">Step 8: Merge the UI and the simulation code</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_07/" class="dropdown-item">Assignment 7</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08.1 CGI Programming</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../08.1_CGI/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../08.1_CGI/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../08.1_CGI/02_Software_distribution/" class="dropdown-item">Software Distribution</a>
</li>
            
<li>
    <a href="../../08.1_CGI/03_Web_computing/" class="dropdown-item">Web Computing</a>
</li>
            
<li>
    <a href="../../08.1_CGI/04_Introduction_to_CGI/" class="dropdown-item">Introduction to CGI</a>
</li>
            
<li>
    <a href="../../08.1_CGI/05_Your_first_web_server/" class="dropdown-item">Your first web server</a>
</li>
            
<li>
    <a href="../../08.1_CGI/06_Testing_static_serving/" class="dropdown-item">Testing static serving</a>
</li>
            
<li>
    <a href="../../08.1_CGI/07_Testing_CGI_serving/" class="dropdown-item">Testing CGI serving</a>
</li>
            
<li>
    <a href="../../08.1_CGI/08_Toward_a_real_CGI_program/" class="dropdown-item">Toward a real CGI program</a>
</li>
            
<li>
    <a href="../../08.1_CGI/09_The_input_form/" class="dropdown-item">The input form</a>
</li>
            
<li>
    <a href="../../08.1_CGI/10_The_processing_script/" class="dropdown-item">The processing script</a>
</li>
            
<li>
    <a href="../../08.1_CGI/11_Unifying_input_form_and_processing_script/" class="dropdown-item">Unifying the input form and the processing script</a>
</li>
            
<li>
    <a href="../../08.1_CGI/12_Fancier_input/" class="dropdown-item">Fancier input</a>
</li>
            
<li>
    <a href="../../08.1_CGI/14_Fancier_output/" class="dropdown-item">Fancier output</a>
</li>
            
<li>
    <a href="../../08.1_CGI/Mxx_Assignment/" class="dropdown-item">Assignment xx</a>
</li>
            
<li>
    <a href="../../08.1_CGI/Stupid/" class="dropdown-item">Stupid</a>
</li>
            
<li>
    <a href="../../08.1_CGI/mi2km_input_v3/" class="dropdown-item">Mi2km input v3</a>
</li>
            
<li>
    <a href="../../08.1_CGI/mi2km_output_v3/" class="dropdown-item">Mi2km output v3</a>
</li>
            
<li>
    <a href="../../08.1_CGI/pWeatherServer-input/" class="dropdown-item">Whitehorse Weather Server</a>
</li>
            
<li>
    <a href="../../08.1_CGI/pWeatherServer-output/" class="dropdown-item">Whitehorse Weather Server</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08.2 Mazes 2</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../08.2_Mazes_2/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../08.2_Mazes_2/01_Interactive_Maze/" class="dropdown-item">An Interactive Maze</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_08/" class="dropdown-item">Assignment 8</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09.1 Median Finding</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../09.1_Median/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../09.1_Median/01_Introduction/" class="dropdown-item">Introduction: median()</a>
</li>
            
<li>
    <a href="../../09.1_Median/02_median_by_partn_0/" class="dropdown-item">Median by Partitioning: Version 0</a>
</li>
            
<li>
    <a href="../../09.1_Median/03_median_by_partn_1/" class="dropdown-item">Median by Partitioning: Version 1</a>
</li>
            
<li>
    <a href="../../09.1_Median/04_median_by_partn_2/" class="dropdown-item">Median by Partitioning: Version 2</a>
</li>
            
<li>
    <a href="../../09.1_Median/05_median_by_partn_3/" class="dropdown-item">Median by Partitioning: Version 3</a>
</li>
            
<li>
    <a href="../../09.1_Median/06_median_by_bounding_0/" class="dropdown-item">Median by Bounding: Version 0</a>
</li>
            
<li>
    <a href="../../09.1_Median/07_median_by_bounding_1/" class="dropdown-item">Median by Bounding: Version 1</a>
</li>
            
<li>
    <a href="../../09.1_Median/08_median_by_bounding_2/" class="dropdown-item">Median by Bounding: Version 2</a>
</li>
            
<li>
    <a href="../../09.1_Median/09_median_by_bounding_3/" class="dropdown-item">Median by Bounding: Version 3</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09.2 Data Processing</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../09.2_Data_Processing/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../09.2_Data_Processing/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../09.2_Data_Processing/02_Spelling_bee_The_problem/" class="dropdown-item">Spelling Bee: The Problem</a>
</li>
            
<li>
    <a href="../../09.2_Data_Processing/03_Spelling_bee_Data_processing_view/" class="dropdown-item">Data Processing View</a>
</li>
            
<li>
    <a href="../../09.2_Data_Processing/04_Spelling_bee_Potential_problems/" class="dropdown-item">Potential Problems</a>
</li>
            
<li>
    <a href="../../09.2_Data_Processing/05_Python_exceptions/" class="dropdown-item">Python Exceptions</a>
</li>
            
<li>
    <a href="../../09.2_Data_Processing/06_EasyGUI/" class="dropdown-item">EasyGUI</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_09/" class="dropdown-item">Assignment 9</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10.1 HTTP and REST</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../02_The_problem_with_CGI/" class="dropdown-item">The problem with CGI</a>
</li>
            
<li>
    <a href="../03_The_world_wide_web/" class="dropdown-item">The World Wide Web</a>
</li>
            
<li>
    <a href="../04_The_inner_nature_of_HTTP/" class="dropdown-item">The inner nature of HTTP</a>
</li>
            
<li>
    <a href="../05_HTTP_on_the_wire/" class="dropdown-item">HTTP on the wire”</a>
</li>
            
<li>
    <a href="../06_Browsing_without_a_browser/" class="dropdown-item">Browsing without a browser</a>
</li>
            
<li>
    <a href="../07_CRUD_vs_HTTP/" class="dropdown-item">CRUD vs HTTP</a>
</li>
            
<li>
    <a href="../08_A_minimal_HTTP_server_in_python/" class="dropdown-item">A minimal HTTP server in Python</a>
</li>
            
<li>
    <a href="../09_Demo_Testing_object_server/" class="dropdown-item">Demo: Testing object_server.py</a>
</li>
            
<li>
    <a href="../10_The_ugly_truth_about_browsers/" class="dropdown-item">The ugly truth about browsers</a>
</li>
            
<li>
    <a href="../11_Translating_MVC_CRUD_to_HTTP/" class="dropdown-item">Translating MVC+CRUD to HTTP</a>
</li>
            
<li>
    <a href="../12_Our_HTTP_request_response_cycles/" class="dropdown-item">Our HTTP Request-Response Cycles</a>
</li>
            
<li>
    <a href="../13_Interaction_storyboard/" class="dropdown-item">Interaction Storyboard</a>
</li>
            
<li>
    <a href="../14_Code_reuse/" class="dropdown-item">Code reuse</a>
</li>
            
<li>
    <a href="../15_Mapping_actions_to_HTTP_method_URL_pairs/" class="dropdown-item">Mapping Actions to HTTP Method + URL pairs</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Actual code</a>
</li>
            
<li>
    <a href="../17_To_object_server_1/" class="dropdown-item">Towards an object server: #1 Identify couplings to quote class</a>
</li>
            
<li>
    <a href="../18_To_object_server_2/" class="dropdown-item">Towards an object server: #2 Object creation menu requirements</a>
</li>
            
<li>
    <a href="../19_To_object_server_3/" class="dropdown-item">Towards an object server: #3 Object creation menu Python code</a>
</li>
            
<li>
    <a href="../20_To_object_server_4/" class="dropdown-item">Towards an object server: #4 Final steps</a>
</li>
            
<li>
    <a href="../21_Something_we_re_not_doing/" class="dropdown-item">Something we’re not doing... ...but I thought you might notice, and so should explain.</a>
</li>
            
<li>
    <a href="../22_Summary/" class="dropdown-item">Summary</a>
</li>
            
<li>
    <a href="../HTML5_template/" class="dropdown-item">HTML5 template</a>
</li>
            
<li>
    <a href="../create_a_Quote/" class="dropdown-item">Create form</a>
</li>
            
<li>
    <a href="../home/" class="dropdown-item">QuoteServer Home Page</a>
</li>
            
<li>
    <a href="../page_Object_Creation_Menu/" class="dropdown-item">Object Creation Menu</a>
</li>
            
<li>
    <a href="../page_create_form/" class="dropdown-item">Create form</a>
</li>
            
<li>
    <a href="../page_home/" class="dropdown-item">QuoteServer Home Page</a>
</li>
            
<li>
    <a href="../page_update_form/" class="dropdown-item">Update form</a>
</li>
            
<li>
    <a href="../page_view/" class="dropdown-item">View Quote</a>
</li>
            
<li>
    <a href="../test/" class="dropdown-item">Test</a>
</li>
            
<li>
    <a href="../test_form/" class="dropdown-item">Test form</a>
</li>
            
<li>
    <a href="../update_form/" class="dropdown-item">Update form</a>
</li>
            
<li>
    <a href="../view/" class="dropdown-item">View Quote</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10.2 Image Processing 1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../10.2_IP_1/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../10.2_IP_1/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../10.2_IP_1/02_PIL/" class="dropdown-item">pillow: The Python Imaging Library</a>
</li>
            
<li>
    <a href="../../10.2_IP_1/03_Test_images/" class="dropdown-item">Test Images</a>
</li>
            
<li>
    <a href="../../10.2_IP_1/04_IPO/" class="dropdown-item">IPO Programming</a>
</li>
            
<li>
    <a href="../../10.2_IP_1/05_Point_vs_neighbourhood/" class="dropdown-item">Point vs Neighbourhood Processes</a>
</li>
            
<li>
    <a href="../../10.2_IP_1/06_Edge_detection/" class="dropdown-item">Edge Detection</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_10/" class="dropdown-item">Assignment 10</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11.1 Pitcher Problems</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../11.1_Pitcher_Problems/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/01_The_problem/" class="dropdown-item">Pitcher problems</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/02_By_hand/" class="dropdown-item">First: Do it by hand</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/03_Notice_what_you_did/" class="dropdown-item">Second: Notice what you did</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/04_Identify_the_problem_type/" class="dropdown-item">Third: Identify the problem type</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/05_Formalize_the_algorithm/" class="dropdown-item">Formalize the Algorithm</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/06_Pseudocode/" class="dropdown-item">Pseudocode</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/07_Refinement/" class="dropdown-item">An edge case leads to a refinement</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/08_OOP/" class="dropdown-item">Towards Python: A little OOP</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/09_Pseudocode_translation/" class="dropdown-item">Further towards Python: Pseudocode translation</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/10_Debugging_is_goal/" class="dropdown-item">Debugging is_goal()</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/11_Bitwise_operations/" class="dropdown-item">Interlude: Bitwise operations (really just &amp;)</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/12_is_goal/" class="dropdown-item">Back to our program: is_goal()</a>
</li>
            
<li>
    <a href="../../11.1_Pitcher_Problems/13_Final_program/" class="dropdown-item">Final program</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11.2 Reporting</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../11.2_Reporting/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../11.2_Reporting/01_The_Problem/" class="dropdown-item">A Report Generation Problem</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_11.md" class="dropdown-item">Assignment 11</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">12.1 Image Processing 2</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../12.1_IP_2/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../12.1_IP_2/01_Introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../12.1_IP_2/02_Dynamic_range/" class="dropdown-item">Dynamic Range</a>
</li>
            
<li>
    <a href="../../12.1_IP_2/03_Noise_filtering/" class="dropdown-item">Noise Filtering</a>
</li>
            
<li>
    <a href="../../12.1_IP_2/04_Sharpening/" class="dropdown-item">Sharpening</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">12.2 YG Emails</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../12.2_YG_Emails/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../12.2_YG_Emails/01_Algorithms_and_heuristics/" class="dropdown-item">Algorithms and Heuristics</a>
</li>
            
<li>
    <a href="../../12.2_YG_Emails/02_YG_Introduction/" class="dropdown-item">Introduction: We just want a list of their email addresses”</a>
</li>
            
<li>
    <a href="../../12.2_YG_Emails/03_YG_Goal/" class="dropdown-item">Your Goal</a>
</li>
            
<li>
    <a href="../../12.2_YG_Emails/04_YG_Complications/" class="dropdown-item">Complications</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../Assignments/Assignment_12.md" class="dropdown-item">Assignment 12</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">13.1 Exam Preparation</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../13.1_Exam_Preparation/00_index/" class="dropdown-item">Contents</a>
</li>
            
<li>
    <a href="../../13.1_Exam_Preparation/01_Examinable_topics/" class="dropdown-item">Examinable Topics</a>
</li>
            
<li>
    <a href="../../13.1_Exam_Preparation/02_Exam_study_guide/" class="dropdown-item">Exam Study Guide</a>
</li>
            
<li>
    <a href="../../13.1_Exam_Preparation/03_Redacted_final_exam/" class="dropdown-item">Redacted Final Exam</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Assignments <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Assignments/Assignment_01/" class="dropdown-item">1</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_02/" class="dropdown-item">2</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_03/" class="dropdown-item">3</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_04/" class="dropdown-item">4</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_05/" class="dropdown-item">5</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_06/" class="dropdown-item">6</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_07/" class="dropdown-item">7</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_08/" class="dropdown-item">8</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_09/" class="dropdown-item">9</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_10/" class="dropdown-item">10</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_11.md" class="dropdown-item">11</a>
</li>
                                    
<li>
    <a href="../../Assignments/Assignment_12.md" class="dropdown-item">12</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../15_Mapping_actions_to_HTTP_method_URL_pairs/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../17_To_object_server_1/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/ttopper/CPSC129/edit/main/docs/10.1_HTTP_REST/16_Actual_code.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <!-- <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#actual-code" class="nav-link">Actual code</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div> -->
                    <div class="col-md-12" role="main">

<h1 id="actual-code">Actual code</h1>
<p>The code logic flows quite cleanly from the HTTP Method column. We can
see that ideally we only have any logic with GET requests (since four
actions use GET requests), but that with POST, PUT and DELETE we always
follow a single course of action.</p>
<p>I say ideally because the ugly truth about browsers means that POST will
actually correspond to three possibilities: a true POST, a tunneled
UPDATE, or a tunneled DELETE. This is handled by including a hidden
field in the input forms giving the actual intended method. This
requires modifications to the forms which are provided by quote.py (see
below).</p>
<pre><code class="language-python"># quote_server.py
#
# HTTP server that provides CRUD operations for Quote objects.
#
# Version 5
#
# - Tidied up substantially.
#
# Version 4
#
# - Implemented PUT and DELETE by tunneling them through POST.
#
# Version 3
#
# - Implement all GETs and POSTs pending decision on how to proceed
#   with PUTs and DELETEs.
#
# Version 1
#
# - Tidied up a bit.
#
# Version 0 (archived as object_server_0.py)
#
# - Initial roughing out to demonstrate HTTP concepts in practice.
# - Tries to send genuine PUT and DELETE.

import quote
import model # Was named MVC_model

HTML5_template = open('HTML5_template.html','r').read()

# We will modify http.server to create our server.
import http.server

# Needed to parse the arguments
import urllib.parse

class myHTTPHandler(http.server.BaseHTTPRequestHandler):
    # BaseHTTPRequestHandler will call do_XXX when receiving
    # a request specifying method XXX.
    #
    # The do_XXX methods do not take any arguments because
    # self contains all the request information in its instance attributes.

    def do_GET(self):
        print('GET for', self.path)
        # HTML forms will append a ? to the URL,
        # remove it when present to standardize URLs.
        self.path = self.path.rstrip('?')

        # There are four possible uses of GET we have to distinguish between.
        #   1) GET /
        #       =&gt; return a page displaying all objects in the datastore.
        #   2) GET /object_creation_form
        #       =&gt; return the form for creating objects.
        #   3) GET /uid/HTML_update_form
        #       =&gt; return the update form for object uid.
        #   4) GET /uid
        #       =&gt; return HTML representation of object uid.

        # 1) GET /
        #    =&gt; return a page displaying all objects in the datastore.
        if self.path == '/':
            print('Handling /')
            # Open the datastore and get a list of all the objects in it.
            m = model.Model('test_model')
            obj_set = m.listall()
            m.close()

            # Build the output page:            
            title = 'Quoteserver Home Page'
            title_block = '''
                &lt;h1&gt;QuoteServer Home Page&lt;/h1&gt; 

                &lt;form method=&quot;GET&quot; action=&quot;/object_creation_form&quot;&gt; 
                  &lt;input type=&quot;submit&quot; value=&quot;Add a new Quote&quot; /&gt; 
                &lt;/form&gt; 

                &lt;h2&gt;Current Quotes:&lt;/h2&gt;
            '''
            # Build a list of HTML representations of the objects.
            obj_set_HTML = []
            for obj in obj_set:
                obj_set_HTML.append(obj.HTML())

            # Assemble the body of the page.
            body = '\n'.join([title_block,'\n'.join(obj_set_HTML)])

            # Inject the page body into the page template.
            page = HTML5_template % (title, body)

            # Send the response and any header lines.
            self.send_response(200)
            self.end_headers()

            # Return the page.
            self.wfile.write(page.encode('utf-8'))

        # 2) GET /object_creation_form
        #    =&gt; return the form for creating objects.
        elif self.path == '/object_creation_form':

            # Build the output page:
            title = 'Quote creation form'
            body = quote.CREATION_FORM # Because at the moment we only have Quotes.
            # Inject the page body into the page template.
            page = HTML5_template % (title, body)

            # Send the response and any header lines.
            self.send_response(200)
            self.end_headers()

            # Return the page.
            self.wfile.write(page.encode('utf-8'))

        # 3) GET /uid/HTML_update_form
        #    =&gt; return the update form for object uid.
        elif self.path.endswith('/HTML_update_form'):
            uid = self.path[1:-len('/HTML_update_form')]

            m = model.Model('test_model')
            obj = m.retrieve(uid)
            m.close()

            if obj:
                title = 'Update form for object %s', 
                body = obj.HTML_update_form()
                page = HTML5_template % (title, body)

                self.send_response(200)
                self.end_headers()

                self.wfile.write(page.encode('utf-8'))
            else:
                self.send_response(404) # Not found.
                self.end_headers()                
                print('Error: Object %s not found!' % (uid))

        # 4) GET /uid
        #    =&gt; return HTML representation of object uid.
        else:
            # (The request may not be for /uid but we can safely assume it is
            # since if it isn't not such object will be found and we'll
            # just return an error.)
            uid = self.path[1:] # Trim the leading / from the URL to get a uid.

            m = model.Model('test_model')            
            obj = m.retrieve(uid) # Retrieve the obejct from the datastore.
            m.close()

            if obj:
                title = 'Object %s' % (uid)
                body = obj.HTML() # Call its HTML method.
                page = HTML5_template % (title, body)

                self.send_response(200)
                self.end_headers()

                self.wfile.write(page.encode('utf-8'))
            else:
                self.send_response(404) # Not found.
                self.end_headers()
                print('Error: Object %s not found!' % (uid))

    def do_POST(self):
        # There are three legitimate possible uses of POST we have to
        # distinguish between.
        #
        # The first is the genuine POST:
        #
        #   1) POST /create/objtype
        #      =&gt; Create an obj of class objtype, and
        #         return a page displaying the newly created object.
        #
        # The other two are when we tunnel PUT and DELETE through POST.
        #
        #   2) POST /uid with method field == 'PUT'
        #      =&gt; Modify object uid, and
        #         return a page displaying the modified object.
        #
        #   3) POST /uid with method field == 'DELETE'
        #      =&gt; Delete object uid, and
        #         redirect to the home page.
        #
        # We could detect the true POST by looking at the URL POSTed to,
        # but this would not extend to tunneled PUTs and DELETEs because they
        # both use the same URL.
        #
        # Instead, for similarity of processing, we will test the hidden method
        # field in all three cases and react appropriately.

        # Parse the query string to get method field which means first
        # parsing the form arguments into a dictionary.
        self.query_string = self.rfile.read(int(self.headers['Content-Length']))
        self.args = dict(urllib.parse.parse_qsl(self.query_string))

        # 1) Is it a genuine POST?
        if self.args[b'_method'] == b'POST':
            print('Got a genuine POST')
            # Check that it is posting to a credible URL,
            # i.e. one with form /create/obj_type,
            # i.e. one that at least begins with /create/
            if self.path.startswith('/create/'):
                # The type of object to create is given by the suffix after /create/
                obj_type = self.path[len('/create/'):]

                # Now try to create the object, e.g. quote.HTML_factory(self.args)
                obj = eval(obj_type + '.HTML_factory(self.args)')

                # If creation was successful:         
                if obj:
                    m = model.Model('test_model')
                    m.create(obj)
                    m.close()
                    # Now return a view of the newly created object by redirecting
                    # to its URL.
                    self.send_response(301)
                    self.send_header('Location', '/%s' % obj.uid)
                    self.end_headers()

                # Otherwise something went wrong.
                else:
                    self.send_response(500) # Internal server error.
                    self.end_headers()
                    print('POST Error: obj not created!')

            # Otherwise POSTing to a disallowed URL.         
            else:
                self.send_response(405) # Method not allowed by that resource.
                self.end_headers()
                print('Error: Tried to POST to %s!' % (self.path))

        # 2) Is this POST tunneling a PUT?
        elif self.args[b'_method'] == b'PUT':
            self.do_PUT()

        # 3) Is this POST tunneling a DELETE?
        elif self.args[b'_method'] == b'DELETE':
            self.do_DELETE()

        # 4) Got a bogus method.
        else:
            self.send_response(405) # Method not allowed.
            self.end_headers()
            print('POST Error: method %s not recognized!' % (self.args[b'_method']))

    def do_PUT(self):
        # Check if the query string has already been parsed
        # i.e. if this request was tunneled through a POST.
        # If it wasn't then parse it now.
        if not self.args:
            self.query_string = self.rfile.read(int(self.headers['Content-Length']))
            self.args = dict(urllib.parse.parse_qsl(self.query_string))

        # Get the uid.  
        old_uid = self.path[1:] # Ignore the initial /

        # Fetch the object.                   
        m = model.Model('test_model')
        old_obj = m.retrieve(old_uid)
        m.close()

        # Determine the object type...                        
        obj_type = old_obj.__module__
        # ...and create a new object based on the updated attributes.                        
        new_obj = eval(obj_type + '.HTML_factory(self.args)')

        # If creation was successful:
        if new_obj:
            # Store the new object in the model and delete the old one.
            m = model.Model('test_model')
            new_uid = m.update(old_uid, new_obj)
            m.close()
            # Now return a view of the newly created object by redirecting
            # to its URL.
            self.send_response(301)
            self.send_header('Location', '/%s' % new_obj.uid)
            self.end_headers()

        # Otherwise something went wrong.
        else:
            self.send_response(500) # Internal server error.
            self.end_headers()
            print('UPDATE Error: obj not created!')

    def do_DELETE(self):
        # Get the uid of the object to delete.
        uid = self.path[1:] # Trim the leading / from the URL to get a uid.

        # Access the datastore.
        m = model.Model('test_model')

        # If we delete the object successfully...
        if m.delete(uid):
            # ...redirect the browser to the home page.
            self.send_response(301)
            self.send_header('Location', '/')
            self.end_headers()

        # Otherwise something went wrong.
        else:
            self.send_response(500) # Internal server error.
            self.end_headers()
            print('DELETE failed')
        # In any event close the datastore.
        m.close()

if __name__ == '__main__':
    PORT = 80
    server_address= ('', PORT)
    httpd = http.server.HTTPServer(server_address, myHTTPHandler)
    print('Serving on port', PORT, '...')
    httpd.serve_forever()

</code></pre>
<pre><code class="language-python"># quote.py
#
# Version 3
#
# Changes:
#
# - Adding HTML methods.
# - Rename factory to be console_factory
# - Rename update to be console_update
#
# Version 2 (archived as quote_2.py)
#
# Changes:
#
# - Implemented Quote.update() method.
#
# Version 1 (archived as quote_1.py)
#
# Changes:
#
# - Changed naming convention to initial lower case to ease  importing.
#
# - Added creation method to be called from controller when new Quote
#   object is required.
#
# - Changed name of object creation routine from &quot;create&quot; to &quot;factory&quot;
#   to avoid confusion with Model.create and to follow common practice
#   of Factory patterns
#   (see e.g. http://en.wikipedia.org/wiki/Factory_method_pattern).
#
# Version 0 (archived as Quote_0.py)
#
# - Initial roughing out.

def console_factory():
    '''Handles console interaction required to create a new Quote object.'''
    author = input('Who is the author of the quote? ')
    text = input('What did they say or write? ')
    return Quote(author, text)

def HTML_factory(form_dict):
    '''Builds a Quote from the data returned in the form
    CREATION_FORM.'''
    author = form_dict[b'author'].decode('utf-8')
    text = form_dict[b'text'].decode('utf-8')
    return Quote(author, text)

# Use this template for both creation via POST and update via PUT.
CREATION_FORM = '''
&lt;h1&gt;Create form&lt;/h1&gt;

&lt;div&gt; 
    &lt;form method=&quot;POST&quot; action=&quot;http://localhost/create/quote&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;POST&quot; /&gt;
        &lt;label
for=&quot;text&quot;&gt;Text:&lt;/label&gt;&lt;textarea id=&quot;text&quot; name=&quot;text&quot; rows=&quot;3&quot;

        cols=&quot;50&quot;&gt;Enter the quote here...&lt;/textarea&gt;&lt;br /&gt; 
        &lt;label for=&quot;author&quot;&gt;Author:&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;author&quot;

        name=&quot;author&quot; size=&quot;50&quot; /&gt;&lt;br /&gt; 
        &lt;label for=&quot;method&quot;&gt;&amp;nbsp;&lt;/label&gt; 
        &lt;input type=&quot;submit&quot; value=&quot;Create&quot; /&gt;
    &lt;/form&gt; 
&lt;/div&gt; 
'''

UPDATE_TEMPLATE = '''
&lt;h1&gt;Update form&lt;/h1&gt;

&lt;div&gt;
    &lt;form method=&quot;POST&quot; action=&quot;http://localhost/%s&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;PUT&quot; /&gt;
        &lt;label
for=&quot;text&quot;&gt;Text:&lt;/label&gt;&lt;textarea id=&quot;text&quot; name=&quot;text&quot; rows=&quot;3&quot;

        cols=&quot;50&quot;&gt;%s&lt;/textarea&gt;&lt;br /&gt; 
        &lt;label for=&quot;author&quot;&gt;Author:&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;author&quot;

        name=&quot;author&quot; size=&quot;50&quot; value=&quot;%s&quot;/&gt;&lt;br /&gt; 
        &lt;label for=&quot;method&quot;&gt;&amp;nbsp;&lt;/label&gt; 
        &lt;input type=&quot;submit&quot; value=&quot;Update&quot; /&gt;
    &lt;/form&gt; 
&lt;/div&gt; 
'''

HTML_TEMPLATE = '''
&lt;div&gt; 
    &lt;blockquote&gt; 
      &lt;p&gt;&lt;span class=&quot;quote-text&quot;&gt;%s&lt;/span&gt; ~
      &lt;span class=&quot;quote-author&quot;&gt;%s&lt;/span&gt;&lt;/p&gt; 
    &lt;/blockquote&gt; 

    &lt;!-- View this quote alone. --&gt;
    &lt;form method=&quot;GET&quot; action=&quot;http://localhost/%s&quot; class=&quot;view&quot;&gt; 
      &lt;input type=&quot;submit&quot; value=&quot;View&quot; /&gt;
    &lt;/form&gt;

    &lt;!-- Request the update form for this quote. --&gt;
    &lt;form method=&quot;GET&quot; action=&quot;http://localhost/%s/HTML_update_form&quot; class=&quot;update&quot;&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Update&quot; /&gt;
    &lt;/form&gt;

    &lt;!-- Delete this quote. --&gt;
    &lt;form method=&quot;POST&quot; action=&quot;http://localhost/%s&quot; class=&quot;delete&quot;&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;DELETE&quot; /&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Delete&quot; /&gt; 
    &lt;/form&gt; 
&lt;/div&gt;
'''

class Quote:
    def __init__(self, author='', text=''):
        self.author = author
        self.text = text
        self.uid = str(hash('Quote' + self.author + self.text))

    def __str__(self):
        return '[%s] %s said &quot;%s&quot;' % (self.uid, self.author, self.text)

    def HTML(self):
        return HTML_TEMPLATE % (self.text, self.author, self.uid, self.uid, self.uid)

    def HTML_update_form(self):
        return UPDATE_TEMPLATE % (self.uid, self.text, self.author)

    def console_update(self):
        '''Handles the console interaction required to modify a Quote object.'''

        print('The current author is:', self.author)
        change = input('Modify author (y/n)? ')
        if change in ['y', 'Y']:
            self.author = input('Enter modified author: ')
        print('The current text is:', self.text)
        change = input('Modify text (y/n)? ')
        if change in ['y', 'Y']:
            self.text = input('Enter modified text: ')
        self.uid = str(hash('Quote' + self.author + self.text))        

if __name__ == '__main__':
    def bordered(s):
        return len(s)*'='+'\n'+s+'\n'+len(s)*'-'

    print(bordered('Testing __init__() and __str__()'))
    q = Quote( 'Kent Beck', 'Optimism is an occupational hazard of programming: testing is the treatment.')
    r = Quote( 'Brian Kernighan', 'Controlling complexity is the essence of computer programming.')
    print('The Quote q is:')
    print('\t', q)
    print('The Quote r is:')
    print('\t', r)
    print()

    print(bordered('Testing HTML()'))
    print('Here’s the HTMl representation of q:')
    print(q.HTML())

##    print(bordered('Testing console_factory()'))
##    s = console_factory()
##    print('Here’s the new Quote object:')
##    print('\t', s)
##    print('Did factory create a Quote object?',)
##    print(type(s) == type(q)) # Checks that factory is returning a Quote object.
##    print()
##
##    print(bordered('Testing console_update()'))
##    print('The Quote q before:')
##    print('\t', q)
##    print()
##    print('Calling console_update():')
##    print()
##    q.console_update()
##    print()
##    print('The Quote q after:')
##    print('\t', q)
##    print()
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 Unported License</a>.</p>
            <!-- <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p> -->
        </footer>

        <script>
            function OneX() {
                document.querySelector('video').playbackRate = 1.0;
            }
            function OnePointFiveX() {
                document.querySelector('video').playbackRate = 1.5;
            }
            function TwoX() {
                document.querySelector('video').playbackRate = 2.0;
            }
        </script>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
